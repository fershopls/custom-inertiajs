var e,t=require("qs"),n=(e=require("deepmerge"))&&"object"==typeof e&&"default"in e?e.default:e;function r(){return(r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var i,o={modal:null,listener:null,show:function(e){var t=this;"object"==typeof e&&(e="All Inertia requests must receive a valid Inertia response, however a plain JSON response was received.<hr>"+JSON.stringify(e));var n=document.createElement("html");n.innerHTML=e,n.querySelectorAll("a").forEach(function(e){return e.setAttribute("target","_top")}),this.modal=document.createElement("div"),this.modal.style.position="fixed",this.modal.style.width="100vw",this.modal.style.height="100vh",this.modal.style.padding="50px",this.modal.style.boxSizing="border-box",this.modal.style.backgroundColor="rgba(0, 0, 0, .6)",this.modal.style.zIndex=2e5,this.modal.addEventListener("click",function(){return t.hide()});var r=document.createElement("iframe");if(r.style.backgroundColor="white",r.style.borderRadius="5px",r.style.width="100%",r.style.height="100%",this.modal.appendChild(r),document.body.prepend(this.modal),document.body.style.overflow="hidden",!r.contentWindow)throw new Error("iframe not yet ready.");r.contentWindow.document.open(),r.contentWindow.document.write(n.outerHTML),r.contentWindow.document.close(),this.listener=this.hideOnEscape.bind(this),document.addEventListener("keydown",this.listener)},hide:function(){this.modal.outerHTML="",this.modal=null,document.body.style.overflow="visible",document.removeEventListener("keydown",this.listener)},hideOnEscape:function(e){27===e.keyCode&&this.hide()}};function s(e,t){var n;return function(){var r=arguments,i=this;clearTimeout(n),n=setTimeout(function(){return e.apply(i,[].slice.call(r))},t)}}function a(e,t,n){for(var r in void 0===t&&(t=new FormData),void 0===n&&(n=null),e=e||{})Object.prototype.hasOwnProperty.call(e,r)&&l(t,c(n,r),e[r]);return t}function c(e,t){return e?e+"["+t+"]":t}function l(e,t,n){return Array.isArray(n)?Array.from(n.keys()).forEach(function(r){return l(e,c(t,r.toString()),n[r])}):n instanceof Date?e.append(t,n.toISOString()):n instanceof File?e.append(t,n,n.name):n instanceof Blob?e.append(t,n):"boolean"==typeof n?e.append(t,n?"1":"0"):"string"==typeof n?e.append(t,n):"number"==typeof n?e.append(t,""+n):null==n?e.append(t,""):void a(n,e,t)}function u(e){return new URL(e.toString(),window.location.toString())}function d(e,r,i,o){void 0===o&&(o="brackets");var s=/^https?:\/\//.test(r.toString()),a=s||r.toString().startsWith("/"),c=!a&&!r.toString().startsWith("#")&&!r.toString().startsWith("?"),l=r.toString().includes("?")||e===exports.Method.GET&&Object.keys(i).length,u=r.toString().includes("#"),d=new URL(r.toString(),"http://localhost");return e===exports.Method.GET&&Object.keys(i).length&&(d.search=t.stringify(n(t.parse(d.search,{ignoreQueryPrefix:!0}),i),{encodeValuesOnly:!0,arrayFormat:o}),i={}),[[s?d.protocol+"//"+d.host:"",a?d.pathname:"",c?d.pathname.substring(1):"",l?d.search:"",u?d.hash:""].join(""),i]}function h(e){return(e=new URL(e.href)).hash="",e}function p(e,t){return document.dispatchEvent(new CustomEvent("inertia:"+e,t))}(i=exports.Method||(exports.Method={})).GET="get",i.POST="post",i.PUT="put",i.PATCH="patch",i.DELETE="delete";var f=function(e){return p("finish",{detail:{visit:e}})},v=function(e){return p("navigate",{detail:{page:e}})},m=window.axios,g="undefined"==typeof window,w=function(){function e(){this.visitId=null}var t=e.prototype;return t.init=function(e){var t=e.resolveComponent,n=e.swapComponent,r=e.visitOptions;m=window.axios,this.page=e.initialPage,this.resolveComponent=t,this.swapComponent=n,this.visitOptions=r,this.isBackForwardVisit()?this.handleBackForwardVisit(this.page):this.isLocationVisit()?this.handleLocationVisit(this.page):this.handleInitialPageVisit(this.page),this.setupEventListeners()},t.handleInitialPageVisit=function(e){this.page.url+=window.location.hash,this.setPage(e,{preserveState:!0}).then(function(){return v(e)})},t.setupEventListeners=function(){window.addEventListener("popstate",this.handlePopstateEvent.bind(this)),document.addEventListener("scroll",s(this.handleScrollEvent.bind(this),100),!0)},t.scrollRegions=function(){return document.querySelectorAll("[scroll-region]")},t.handleScrollEvent=function(e){"function"==typeof e.target.hasAttribute&&e.target.hasAttribute("scroll-region")&&this.saveScrollPositions()},t.saveScrollPositions=function(){this.replaceState(r({},this.page,{scrollRegions:Array.from(this.scrollRegions()).map(function(e){return{top:e.scrollTop,left:e.scrollLeft}})}))},t.resetScrollPositions=function(){var e;document.documentElement.scrollTop=0,document.documentElement.scrollLeft=0,this.scrollRegions().forEach(function(e){e.scrollTop=0,e.scrollLeft=0}),this.saveScrollPositions(),window.location.hash&&(null==(e=document.getElementById(window.location.hash.slice(1)))||e.scrollIntoView())},t.restoreScrollPositions=function(){var e=this;this.page.scrollRegions&&this.scrollRegions().forEach(function(t,n){var r=e.page.scrollRegions[n];r&&(t.scrollTop=r.top,t.scrollLeft=r.left)})},t.isBackForwardVisit=function(){return window.history.state&&window.performance&&window.performance.getEntriesByType("navigation").length>0&&"back_forward"===window.performance.getEntriesByType("navigation")[0].type},t.handleBackForwardVisit=function(e){var t=this;window.history.state.version=e.version,this.setPage(window.history.state,{preserveScroll:!0,preserveState:!0}).then(function(){t.restoreScrollPositions(),v(e)})},t.locationVisit=function(e,t){try{window.sessionStorage.setItem("inertiaLocationVisit",JSON.stringify({preserveScroll:t})),window.location.href=e.href,h(window.location).href===h(e).href&&window.location.reload()}catch(e){return!1}},t.isLocationVisit=function(){try{return null!==window.sessionStorage.getItem("inertiaLocationVisit")}catch(e){return!1}},t.handleLocationVisit=function(e){var t,n,r,i,o=this,s=JSON.parse(window.sessionStorage.getItem("inertiaLocationVisit")||"");window.sessionStorage.removeItem("inertiaLocationVisit"),e.url+=window.location.hash,e.rememberedState=null!=(t=null==(n=window.history.state)?void 0:n.rememberedState)?t:{},e.scrollRegions=null!=(r=null==(i=window.history.state)?void 0:i.scrollRegions)?r:[],this.setPage(e,{preserveScroll:s.preserveScroll,preserveState:!0}).then(function(){s.preserveScroll&&o.restoreScrollPositions(),v(e)})},t.isLocationVisitResponse=function(e){return!(!e||409!==e.status||!e.headers["x-inertia-location"])},t.isInertiaResponse=function(e){return!(null==e||!e.headers["x-inertia"])},t.createVisitId=function(){return this.visitId={},this.visitId},t.cancelVisit=function(e,t){var n=t.cancelled,r=void 0!==n&&n,i=t.interrupted,o=void 0!==i&&i;!e||e.completed||e.cancelled||e.interrupted||(e.cancelToken.cancel(),e.onCancel(),e.completed=!1,e.cancelled=r,e.interrupted=o,f(e),e.onFinish(e))},t.finishVisit=function(e){e.cancelled||e.interrupted||(e.completed=!0,e.cancelled=!1,e.interrupted=!1,f(e),e.onFinish(e))},t.resolvePreserveOption=function(e,t){return"function"==typeof e?e(t):"errors"===e?Object.keys(t.props.errors||{}).length>0:e},t.visit=function(e,t){var n=this;void 0===t&&(t={}),console.log("Visiting: "+e);var i=r({method:exports.Method.GET,data:{},replace:!1,preserveScroll:!1,preserveState:!1,only:[],headers:{},errorBag:"",forceFormData:!1,queryStringArrayFormat:"brackets",onCancelToken:function(){},onBefore:function(){},onStart:function(){},onProgress:function(){},onFinish:function(){},onCancel:function(){},onSuccess:function(){},onError:function(){}},t),s="string"==typeof e?u(e):e,c=this.visitOptions&&this.visitOptions(i,s)||i,l=c.method,f=c.replace,v=c.only,g=c.headers,w=c.errorBag,S=c.forceFormData,y=c.queryStringArrayFormat,b=c.onCancelToken,E=c.onBefore,P=c.onStart,x=c.onProgress,I=c.onFinish,V=c.onCancel,T=c.onSuccess,O=c.onError,L=c.data,C=c.preserveScroll,k=c.preserveState;if(!function e(t){return t instanceof File||t instanceof Blob||t instanceof FileList&&t.length>0||t instanceof FormData&&Array.from(t.values()).some(function(t){return e(t)})||"object"==typeof t&&null!==t&&Object.values(t).some(function(t){return e(t)})}(L)&&!S||L instanceof FormData||(L=a(L)),!(L instanceof FormData)){var M=d(l,s,L,y),A=M[1];s=u(M[0]),L=A}var F={url:s,method:l,data:L,replace:f,preserveScroll:C,preserveState:k,only:v,headers:g,errorBag:w,forceFormData:S,queryStringArrayFormat:y,cancelled:!1,completed:!1,interrupted:!1};if(!1!==E(F)&&function(e){return p("before",{cancelable:!0,detail:{visit:e}})}(F)){this.activeVisit&&this.cancelVisit(this.activeVisit,{interrupted:!0}),this.saveScrollPositions();var R=this.createVisitId();this.activeVisit=r({},F,{onCancelToken:b,onBefore:E,onStart:P,onProgress:x,onFinish:I,onCancel:V,onSuccess:T,onError:O,queryStringArrayFormat:y,cancelToken:m.CancelToken.source()}),b({cancel:function(){n.activeVisit&&n.cancelVisit(n.activeVisit,{cancelled:!0})}}),function(e){p("start",{detail:{visit:e}})}(F),P(F),m({method:l,url:s.pathname+s.search,data:l===exports.Method.GET?{}:L,params:l===exports.Method.GET?L:{},cancelToken:this.activeVisit.cancelToken.token,headers:r({},g,{Accept:"text/html, application/xhtml+xml","X-Requested-With":"XMLHttpRequest","X-Inertia":!0},v.length?{"X-Inertia-Partial-Component":this.page.component,"X-Inertia-Partial-Data":v.join(",")}:{},w&&w.length?{"X-Inertia-Error-Bag":w}:{},this.page.version?{"X-Inertia-Version":this.page.version}:{}),onUploadProgress:function(e){L instanceof FormData&&(e.percentage=Math.round(e.loaded/e.total*100),function(e){p("progress",{detail:{progress:e}})}(e),x(e))}}).then(function(e){var t;if(!n.isInertiaResponse(e))return Promise.reject({response:e});var i=e.data;v.length&&i.component===n.page.component&&(i.props=r({},n.page.props,i.props)),C=n.resolvePreserveOption(C,i),(k=n.resolvePreserveOption(k,i))&&null!=(t=window.history.state)&&t.rememberedState&&i.component===n.page.component&&(i.rememberedState=window.history.state.rememberedState);var o=s,a=u(i.url);return o.hash&&!a.hash&&h(o).href===a.href&&(a.hash=o.hash,i.url=a.href),n.setPage(i,{visitId:R,replace:f,preserveScroll:C,preserveState:k})}).then(function(){var e=n.page.props.errors||{};if(Object.keys(e).length>0){var t=w?e[w]?e[w]:{}:e;return function(e){p("error",{detail:{errors:e}})}(t),O(t)}return p("success",{detail:{page:n.page}}),T(n.page)}).catch(function(e){if(n.isInertiaResponse(e.response))return n.setPage(e.response.data,{visitId:R});if(n.isLocationVisitResponse(e.response)){var t=u(e.response.headers["x-inertia-location"]),r=s;r.hash&&!t.hash&&h(r).href===t.href&&(t.hash=r.hash),n.locationVisit(t,!0===C)}else{if(!e.response)return Promise.reject(e);p("invalid",{cancelable:!0,detail:{response:e.response}})&&o.show(e.response.data)}}).then(function(){n.activeVisit&&n.finishVisit(n.activeVisit)}).catch(function(e){if(!m.isCancel(e)){var t=p("exception",{cancelable:!0,detail:{exception:e}});if(n.activeVisit&&n.finishVisit(n.activeVisit),t)return Promise.reject(e)}})}},t.setPage=function(e,t){var n=this,r=void 0===t?{}:t,i=r.visitId,o=void 0===i?this.createVisitId():i,s=r.replace,a=void 0!==s&&s,c=r.preserveScroll,l=void 0!==c&&c,d=r.preserveState,h=void 0!==d&&d;return Promise.resolve(this.resolveComponent(e.component)).then(function(t){o===n.visitId&&(e.scrollRegions=e.scrollRegions||[],e.rememberedState=e.rememberedState||{},(a=a||u(e.url).href===window.location.href)?n.replaceState(e):n.pushState(e),n.swapComponent({component:t,page:e,preserveState:h}).then(function(){l||n.resetScrollPositions(),a||v(e)}))})},t.pushState=function(e){this.page=e,window.history.pushState(e,"",e.url)},t.replaceState=function(e){this.page=e,window.history.replaceState(e,"",e.url)},t.handlePopstateEvent=function(e){var t=this;if(null!==e.state){var n=e.state,i=this.createVisitId();Promise.resolve(this.resolveComponent(n.component)).then(function(e){i===t.visitId&&(t.page=n,t.swapComponent({component:e,page:n,preserveState:!1}).then(function(){t.restoreScrollPositions(),v(n)}))})}else{var o=u(this.page.url);o.hash=window.location.hash,this.replaceState(r({},this.page,{url:o.href})),this.resetScrollPositions()}},t.get=function(e,t,n){return void 0===t&&(t={}),void 0===n&&(n={}),this.visit(e,r({},n,{method:exports.Method.GET,data:t}))},t.reload=function(e){return void 0===e&&(e={}),this.visit(window.location.href,r({},e,{preserveScroll:!0,preserveState:!0}))},t.replace=function(e,t){var n;return void 0===t&&(t={}),console.warn("Inertia.replace() has been deprecated and will be removed in a future release. Please use Inertia."+(null!=(n=t.method)?n:"get")+"() instead."),this.visit(e,r({preserveState:!0},t,{replace:!0}))},t.post=function(e,t,n){return void 0===t&&(t={}),void 0===n&&(n={}),this.visit(e,r({preserveState:!0},n,{method:exports.Method.POST,data:t}))},t.put=function(e,t,n){return void 0===t&&(t={}),void 0===n&&(n={}),this.visit(e,r({preserveState:!0},n,{method:exports.Method.PUT,data:t}))},t.patch=function(e,t,n){return void 0===t&&(t={}),void 0===n&&(n={}),this.visit(e,r({preserveState:!0},n,{method:exports.Method.PATCH,data:t}))},t.delete=function(e,t){return void 0===t&&(t={}),this.visit(e,r({preserveState:!0},t,{method:exports.Method.DELETE}))},t.remember=function(e,t){var n,i;void 0===t&&(t="default"),g||this.replaceState(r({},this.page,{rememberedState:r({},null==(n=this.page)?void 0:n.rememberedState,(i={},i[t]=e,i))}))},t.restore=function(e){var t,n;if(void 0===e&&(e="default"),!g)return null==(t=window.history.state)||null==(n=t.rememberedState)?void 0:n[e]},t.on=function(e,t){var n=function(e){var n=t(e);e.cancelable&&!e.defaultPrevented&&!1===n&&e.preventDefault()};return document.addEventListener("inertia:"+e,n),function(){return document.removeEventListener("inertia:"+e,n)}},e}(),S={buildDOMElement:function(e){var t=document.createElement("template");t.innerHTML=e;var n=t.content.firstChild;if(!e.startsWith("<script "))return n;var r=document.createElement("script");return r.innerHTML=n.innerHTML,n.getAttributeNames().forEach(function(e){r.setAttribute(e,n.getAttribute(e)||"")}),r},isInertiaManagedElement:function(e){return e.nodeType===Node.ELEMENT_NODE&&null!==e.getAttribute("inertia")},findMatchingElementIndex:function(e,t){var n=e.getAttribute("inertia");return null!==n?t.findIndex(function(e){return e.getAttribute("inertia")===n}):-1},update:s(function(e){var t=this,n=e.map(function(e){return t.buildDOMElement(e)});Array.from(document.head.childNodes).filter(function(e){return t.isInertiaManagedElement(e)}).forEach(function(e){var r=t.findMatchingElementIndex(e,n);if(-1!==r){var i,o=n.splice(r,1)[0];o&&!e.isEqualNode(o)&&(null==e||null==(i=e.parentNode)||i.replaceChild(o,e))}else{var s;null==e||null==(s=e.parentNode)||s.removeChild(e)}}),n.forEach(function(e){return document.head.appendChild(e)})},1)},y=new w;exports.Inertia=y,exports.createHeadManager=function(e,t,n){var i={},o=0;function s(){var e=t(""),n=r({},e?{title:'<title inertia="">'+e+"</title>"}:{}),o=Object.values(i).reduce(function(e,t){return e.concat(t)},[]).reduce(function(e,n){if(-1===n.indexOf("<"))return e;if(0===n.indexOf("<title ")){var r=n.match(/(<title [^>]+>)(.*?)(<\/title>)/);return e.title=r?""+r[1]+t(r[2])+r[3]:n,e}var i=n.match(/ inertia="[^"]+"/);return i?e[i[0]]=n:e[Object.keys(e).length]=n,e},n);return Object.values(o)}function a(){e?n(s()):S.update(s())}return a(),{forceUpdate:a,createProvider:function(){var e=function(){var e=o+=1;return i[e]=[],e.toString()}();return{update:function(t){return function(e,t){void 0===t&&(t=[]),null!==e&&Object.keys(i).indexOf(e)>-1&&(i[e]=t),a()}(e,t)},disconnect:function(){return function(e){null!==e&&-1!==Object.keys(i).indexOf(e)&&(delete i[e],a())}(e)}}}}},exports.hrefToUrl=u,exports.mergeDataIntoQueryString=d,exports.shouldIntercept=function(e){var t="a"===e.currentTarget.tagName.toLowerCase();return!(e.target&&null!=e&&e.target.isContentEditable||e.defaultPrevented||t&&e.which>1||t&&e.altKey||t&&e.ctrlKey||t&&e.metaKey||t&&e.shiftKey)},exports.urlWithoutHash=h;
//# sourceMappingURL=index.js.map
